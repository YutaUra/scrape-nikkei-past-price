まず初めにこのプログラムを利用する場合は [ライセンス](https://github.com/YutaUra/scrape-nikkei-past-price/blob/main/LICENSE) をご確認し、よく理解した上でご利用ください。ライセンスについて不明な点がある場合はメールまたは issue にてお問い合わせください。

## インストール方法

1. [リリースページ](https://github.com/YutaUra/scrape-nikkei-past-price/releases) にあるもののうち、最新のリリースを確認してください。
2. 最新のリリースの中に Assets という項目があります。そのうちご自身の PC にあったファイルをクリックしダウンロードしてください。
  - Windowsであれば、おおよそ `*_Windows_x86_64.tar.gz`
  - Mac の Intel チップ であれば `*_Darwin_x86_64.tar.gz`
  - Mac の Sillicon チップ であれば `*_Darwin_arm64.tar.gz`
  - Linux であれば、おおよそ `*_Linux_x86_64.tar.gz`
3. 上記のファイルを解凍してください。
4. そうすると `scrape-nikkei-past-price` という名前のファイルができます。（Windowsであれば `scrape-nikkei-past-price.exe`とかになってるかも？）
5. （オプション）環境変数 `PATH` に含まれるディレクトリに 4 で生成されたファイルをコピーしてください。

## 使い方

1. ターミナルを開く。（Windowsであればコマンドプロンプトなど）
2. `cd` コマンドを利用して `scrape-nikkei-past-price` ファイルが存在するディレクトリに移動する（デフォルトだとダウンロードディレクトリにあるはず）
  なお、このステップはインストール時に 5 番目のステップを実行していた場合スキップできる。
3. `scrape-nikkei-past-price` コマンドを実行する。
  - Windows であれば `./scrape-nikkei-past-price.exe` として実行できる
  - Mac, Linux であれば `./scrape-nikkei-past-price` として実行できる

### 引数

この説明は `./scrape-nikkei-past-price --help` コマンドを実行すると表示される。

| 引数          | 説明                                                                                                                   | 必須かどうか                 |
| ------------- | ---------------------------------------------------------------------------------------------------------------------- | ---------------------------- |
| --input       | 入力ファイルのパスを指定する。                                                                                         | 必須                         |
| --output      | 出力ファイルのパスを指定する。                                                                                         | 必須                         |
| --header      | 入力ファイルのうちヘッダーとして読み飛ばす行数を指定する。                                                             | 必須ではない。デフォルトは 1 |
| --concurrency | 同時に実行するスレッドの数を指定する。値が大きいほど処理は速くなりますが、自身のPCと日経へのサーバーへの負担が増えます | 必須ではない。デフォルトは 5 |


### 入力ファイルの形式

- `csv` 形式を指定してください。 excel 形式は対応してません
- １列目に検索したい企業の名称を記入してください。
- １列目以外の列は無視されます
- ファイルエンコーディングは自動で推定されますが、推奨は utf-8 です。（Shift-JIS には対応しています）

例：
```csv
企業名
ＩＨＩ
アイネス
アイホン
```

### コマンド実行具体例

`input.csv` というファイルが同じディレクトリ上に存在している場合
```bash
./scrape-nikkei-past-price --input ./input.csv --output ./output.csv
```

ヘッダー部分が３行分ある場合
```bash
./scrape-nikkei-past-price --input ./input.csv --output ./output.csv --header 3
```

最大同時実行数を10にする場合
```bash
./scrape-nikkei-past-price --input ./input.csv --output ./output.csv --concurrency 10
``` 

### 出力ファイルの形式

- `csv` 形式となります。
- ファイルエンコーディングは utf-8 です。
- 処理の都合上、 input ファイルと同じ順番で出力されません。その代わりに input ファイルでの行数が `index` 列に保存されています。

| 列数 | 列名   | 説明                       |
| ---- | ------ | -------------------------- |
| 1    | 企業名 | 企業の名前です             |
| 2    | index  | input ファイルでの行数     |
| 3    | コード | 証券取扱コード的なやつです |
| 4    | 2013   | 2013年の最高終値           |
| 5    | 2014   | 2014年の最高終値           |
| 6    | 2015   | 2015年の最高終値           |
| 7    | 2016   | 2016年の最高終値           |
| 8    | 2017   | 2017年の最高終値           |
| 9    | 2018   | 2018年の最高終値           |
| 10   | 2019   | 2019年の最高終値           |
| 11   | 2020   | 2020年の最高終値           |
| 12   | 2021   | 2021年の最高終値           |
| 13   | 2022   | 2022年の最高終値           |
